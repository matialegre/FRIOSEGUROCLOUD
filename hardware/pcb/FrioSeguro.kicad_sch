(kicad_sch (version 20230121) (generator eeschema)

  (uuid e6cd02be-94c3-c3f8-01be-2f764cd05ab8)

  (paper "A3")

  (title_block
    (title "FrioSeguro - Sistema Monitoreo Reefer")
    (date "2026-01-13")
    (rev "1.0")
    (company "Pandemonium Tech / Pan American Silver")
    (comment 1 "PCB Modular: Versión Básica y Premium")
    (comment 2 "Diseñado para ESP32 NodeMCU 38 pines")
  )

  (lib_symbols
  )

  (text "╔══════════════════════════════════════════════════════════════════════════════════════╗\n║                           FRIOSEGURO PCB v1.0 - ESQUEMÁTICO                          ║\n║                      Sistema de Monitoreo de Temperatura para Reefers                 ║\n╠══════════════════════════════════════════════════════════════════════════════════════╣\n║  CARACTERÍSTICAS:                                                                     ║\n║  • ESP32 NodeMCU 38 pines como controlador principal                                 ║\n║  • 3x Entradas para sensores DS18B20 (bus OneWire con R 4.7K)                        ║\n║  • 3x Entradas para sensores de puerta (Reed Switch)                                 ║\n║  • 1x Entrada detección AC 220V (divisor resistivo aislado)                          ║\n║  • 1x Entrada señal defrost del reefer                                               ║\n║  • 2x Salidas relay (módulo 2CH TTL)                                                 ║\n║  • 1x Buzzer                                                                          ║\n║  • 2x LEDs indicadores (OK/Alerta)                                                   ║\n║  • Alimentación USB 5V                                                                ║\n║                                                                                       ║\n║  ZONA PREMIUM (opcional):                                                             ║\n║  • SIM800L para conectividad GSM/GPRS                                                ║\n║  • Shield cargador batería 18650                                                     ║\n║  • Step-down para SIM800L (4.0V)                                                     ║\n║  • Jumpers de selección de alimentación                                              ║\n╚══════════════════════════════════════════════════════════════════════════════════════╝"
    (at 25 25 0)
    (effects (font (size 2 2)) (justify left))
  )

  (text "═══════════════════════════════════════\n         ASIGNACIÓN DE PINES ESP32\n═══════════════════════════════════════\n\nGPIO0  - Botón BOOT (Reset WiFi)\nGPIO2  - LED integrado (OK)\nGPIO4  - Bus OneWire (DS18B20 x3)\nGPIO5  - Sensor Puerta 1\nGPIO12 - Sensor Puerta 2\nGPIO13 - Sensor Puerta 3\nGPIO14 - Detección AC 220V\nGPIO15 - LED Alerta\nGPIO16 - TX2 → SIM800L RX\nGPIO17 - RX2 ← SIM800L TX\nGPIO18 - Buzzer\nGPIO25 - Relay 1 (IN1)\nGPIO26 - Relay 2 (IN2)\nGPIO27 - DHT22 (opcional)\nGPIO32 - Medición voltaje batería\nGPIO33 - Señal Defrost Reefer\nGPIO34 - Entrada analógica libre\nGPIO35 - Entrada analógica libre\n\n═══════════════════════════════════════"
    (at 280 30 0)
    (effects (font (size 1.8 1.8)) (justify left))
  )

  (text "═══════════════════════════════════════════════════════════════\n                    BORNERAS DE CONEXIÓN\n═══════════════════════════════════════════════════════════════\n\n┌─────────────────────────────────────────────────────────────┐\n│ J1 - SENSORES TEMPERATURA DS18B20 (3 posiciones)            │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: GND (común para los 3 sensores)                      │\n│ Pin 2: DATA (GPIO4 con R 4.7K pull-up a 3.3V)              │\n│ Pin 3: VCC 3.3V (común para los 3 sensores)                │\n│                                                             │\n│ NOTA: Los 3 sensores DS18B20 van en paralelo en el mismo   │\n│ bus OneWire. Cada sensor tiene dirección única.            │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J2 - SENSORES DE PUERTA (6 pines - 3 sensores)              │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: GND                                                  │\n│ Pin 2: PUERTA1 (GPIO5)                                      │\n│ Pin 3: GND                                                  │\n│ Pin 4: PUERTA2 (GPIO12)                                     │\n│ Pin 5: GND                                                  │\n│ Pin 6: PUERTA3 (GPIO13)                                     │\n│                                                             │\n│ NOTA: Reed switch entre GND y GPIOx (pull-up interno)      │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J3 - DETECCIÓN AC 220V (2 pines)                            │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: FASE (a través de divisor resistivo)                │\n│ Pin 2: NEUTRO                                               │\n│                                                             │\n│ CIRCUITO: 220V → R1 1M → R2 10K → GPIO14                   │\n│ Con diodo zener 3.3V de protección                         │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J4 - SEÑAL DEFROST REEFER (2 pines)                         │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: GND                                                  │\n│ Pin 2: SEÑAL (GPIO33 con pull-up interno)                  │\n│                                                             │\n│ NOTA: Conectar al relé de defrost del reefer               │\n│ Configurable como NO o NC desde software                   │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J5 - MÓDULO RELAY 2CH (4 pines)                             │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: VCC (5V)                                             │\n│ Pin 2: GND                                                  │\n│ Pin 3: IN1 (GPIO25)                                         │\n│ Pin 4: IN2 (GPIO26)                                         │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J6 - ALIMENTACIÓN USB 5V (2 pines)                          │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: +5V (desde fuente USB)                               │\n│ Pin 2: GND                                                  │\n│                                                             │\n│ NOTA: Conectar fuente USB 5V 2A mínimo                     │\n└─────────────────────────────────────────────────────────────┘"
    (at 25 120 0)
    (effects (font (size 1.5 1.5)) (justify left))
  )

  (text "═══════════════════════════════════════════════════════════════\n              ZONA PREMIUM (OPCIONAL)\n═══════════════════════════════════════════════════════════════\n\n┌─────────────────────────────────────────────────────────────┐\n│ J7 - MÓDULO SIM800L (7 pines)                               │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: VCC (4.0V desde Step-Down)                          │\n│ Pin 2: GND                                                  │\n│ Pin 3: TXD → GPIO17 (RX2 ESP32)                            │\n│ Pin 4: RXD ← GPIO16 (TX2 ESP32)                            │\n│ Pin 5: RST (opcional, a GPIO)                              │\n│ Pin 6: RING (opcional, a GPIO)                             │\n│ Pin 7: DTR (opcional)                                       │\n│                                                             │\n│ ⚠️ IMPORTANTE: SIM800L requiere 4.0V y picos de 2A        │\n│ Usar Step-Down MP1584 configurado a 4.0V                   │\n│ Capacitor 1000uF en entrada del SIM800L                    │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ J8 - SHIELD CARGADOR 18650 (4 pines)                        │\n├─────────────────────────────────────────────────────────────┤\n│ Pin 1: VIN (5V desde USB)                                   │\n│ Pin 2: GND                                                  │\n│ Pin 3: VBAT+ (salida batería ~3.7-4.2V)                    │\n│ Pin 4: VBAT- (GND batería)                                 │\n│                                                             │\n│ NOTA: El shield tiene protección de carga/descarga         │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ JP1 - JUMPER SELECCIÓN ALIMENTACIÓN                         │\n├─────────────────────────────────────────────────────────────┤\n│ Posición 1-2: Alimentación directa USB 5V                  │\n│ Posición 2-3: Alimentación desde batería 18650             │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ JP2 - JUMPER HABILITACIÓN SIM800L                           │\n├─────────────────────────────────────────────────────────────┤\n│ Cerrado: SIM800L habilitado                                │\n│ Abierto: SIM800L deshabilitado (ahorro energía)           │\n└─────────────────────────────────────────────────────────────┘"
    (at 25 320 0)
    (effects (font (size 1.5 1.5)) (justify left))
  )

  (text "═══════════════════════════════════════════════════════════════\n                 CIRCUITOS DE PROTECCIÓN\n═══════════════════════════════════════════════════════════════\n\n┌─────────────────────────────────────────────────────────────┐\n│ DIVISOR RESISTIVO DETECCIÓN AC 220V                         │\n├─────────────────────────────────────────────────────────────┤\n│                                                             │\n│    FASE 220V ──┬── R1 (1MΩ 1/2W) ──┬── R2 (10KΩ) ──┬── GPIO14\n│                │                    │               │       │\n│                │                    │    D1 Zener   │       │\n│                │                    │    3.3V       │       │\n│                │                    │      │        │       │\n│    NEUTRO ─────┴────────────────────┴──────┴────────┴── GND │\n│                                                             │\n│ Cálculo: Vout = 220V × 10K / (1M + 10K) ≈ 2.2V            │\n│ El zener protege contra sobretensiones                     │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ PULL-UP RESISTOR BUS ONEWIRE (DS18B20)                      │\n├─────────────────────────────────────────────────────────────┤\n│                                                             │\n│    3.3V ────── R3 (4.7KΩ) ──┬── GPIO4 (DATA)               │\n│                              │                              │\n│                              ├── DS18B20 #1 DATA           │\n│                              ├── DS18B20 #2 DATA           │\n│                              └── DS18B20 #3 DATA           │\n│                                                             │\n└─────────────────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────────────────┐\n│ CAPACITORES DE FILTRADO                                     │\n├─────────────────────────────────────────────────────────────┤\n│                                                             │\n│ C1: 100uF electrolítico en entrada 5V                      │\n│ C2: 100nF cerámico en VCC ESP32                            │\n│ C3: 100nF cerámico en VCC sensores                         │\n│ C4: 1000uF electrolítico en entrada SIM800L (Premium)      │\n│ C5: 100nF cerámico en salida Step-Down (Premium)           │\n│                                                             │\n└─────────────────────────────────────────────────────────────┘"
    (at 280 120 0)
    (effects (font (size 1.5 1.5)) (justify left))
  )

  (text "═══════════════════════════════════════════════════════════════\n                    LISTA DE MATERIALES (BOM)\n═══════════════════════════════════════════════════════════════\n\n COMPONENTES BÁSICOS (todas las placas):\n ─────────────────────────────────────────\n │ Cant │ Componente                    │ Valor/Modelo      │\n ├──────┼───────────────────────────────┼───────────────────┤\n │  1   │ ESP32 NodeMCU 38 pines        │ NODEMCU-ESP32S    │\n │  1   │ Resistor pull-up OneWire      │ 4.7KΩ 1/4W        │\n │  1   │ Resistor divisor AC (alto)    │ 1MΩ 1/2W          │\n │  1   │ Resistor divisor AC (bajo)    │ 10KΩ 1/4W         │\n │  1   │ Diodo Zener protección        │ 3.3V 500mW        │\n │  1   │ Capacitor filtro entrada      │ 100uF 16V         │\n │  2   │ Capacitor desacoplo           │ 100nF cerámico    │\n │  1   │ LED verde (OK)                │ 3mm verde         │\n │  1   │ LED rojo (Alerta)             │ 3mm rojo          │\n │  2   │ Resistor LED                  │ 330Ω 1/4W         │\n │  1   │ Buzzer activo                 │ 5V                │\n │  1   │ Bornera 3 pines (sensores)    │ 5.08mm pitch      │\n │  1   │ Bornera 6 pines (puertas)     │ 5.08mm pitch      │\n │  1   │ Bornera 2 pines (AC)          │ 5.08mm pitch      │\n │  1   │ Bornera 2 pines (defrost)     │ 5.08mm pitch      │\n │  1   │ Bornera 4 pines (relay)       │ 5.08mm pitch      │\n │  1   │ Bornera 2 pines (USB 5V)      │ 5.08mm pitch      │\n │  1   │ Módulo Relay 2CH TTL          │ 5V                │\n │  3   │ Sensor DS18B20                │ Sonda 2m          │\n │  3   │ Sensor magnético puerta       │ Reed switch       │\n └──────┴───────────────────────────────┴───────────────────┘\n\n COMPONENTES PREMIUM (solo placas con GSM/batería):\n ─────────────────────────────────────────────────────\n │ Cant │ Componente                    │ Valor/Modelo      │\n ├──────┼───────────────────────────────┼───────────────────┤\n │  1   │ Módulo SIM800L                │ Con antena        │\n │  1   │ Shield cargador 18650         │ Con protección    │\n │  1   │ Batería 18650                 │ 2600mAh           │\n │  1   │ Step-Down MP1584              │ Ajustado a 4.0V   │\n │  1   │ Capacitor SIM800L             │ 1000uF 10V        │\n │  1   │ Capacitor Step-Down           │ 100nF cerámico    │\n │  1   │ Header 3 pines (jumper alim)  │ 2.54mm            │\n │  1   │ Header 2 pines (jumper SIM)   │ 2.54mm            │\n │  2   │ Jumper                        │ 2.54mm            │\n │  1   │ Bornera 7 pines (SIM800L)     │ 2.54mm pitch      │\n │  1   │ Bornera 4 pines (batería)     │ 2.54mm pitch      │\n └──────┴───────────────────────────────┴───────────────────┘"
    (at 280 320 0)
    (effects (font (size 1.5 1.5)) (justify left))
  )

)
